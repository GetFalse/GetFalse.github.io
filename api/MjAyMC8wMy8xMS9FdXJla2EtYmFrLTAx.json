{"title":"Eureka-bak-01","date":"2020-03-11T15:01:11.000Z","date_formatted":{"ll":"Mar 11, 2020","L":"03/11/2020","MM-DD":"03-11"},"link":"2020/03/11/Eureka-bak-01","comments":true,"tags":["Eureka"],"categories":["bak"],"updated":"2020-03-12T07:29:02.849Z","content":"<h4 id=\"emergency-eureka-may-be-incorrectly-claiming-instances-are-up-when-theyre-not-renewals-are-lesser-than-threshold-and-hence-the-instances-are-not-being-expired-just-to-be-safe\"><strong>EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY’RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE.</strong><a href=\"#emergency-eureka-may-be-incorrectly-claiming-instances-are-up-when-theyre-not-renewals-are-lesser-than-threshold-and-hence-the-instances-are-not-being-expired-just-to-be-safe\" title=\"EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY’RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE.\"></a></h4><p><img src=\"https://resource.bugbak.com//CWE6HANIf1Iwsg4LC4TqJBMjmmMF419ArwSnYQG4.jpg\" class=\"φcy\"></p>\n<p>访问Eureka控制页面，提示如上，中文解释：<br>紧急!EUREKA可能错误地声明实例已经启动，而实际上它们并没有。续订低于阈值，因此不会为了安全而终止实例。<br>这是由于Renews threshold = 3，Renews (last min)= 2导致的。先解释一下说明这两个参数的含义</p>\n<p>Renews threshold：server期望在每分钟中收到的心跳次数 。<br>Renews (last min)：上一分钟内收到的心跳次数。</p>\n<p>Eurake有一个配置参数eureka.server.renewalPercentThreshold，定义了renews 和renews threshold的比值，默认值为0.85。当server在15分钟内，比值低于percent，即少了15%的微服务心跳，server会进入自我保护状态，Self-Preservation。在此状态下，server不会删除注册信息，这就有可能导致在调用微服务时，实际上服务并不存在。<br>这种保护状态实际上是考虑了client和server之间的心跳是因为网络问题，而非服务本身问题，不能简单的删除注册信息</p>\n<p>stackoverflow上，有人给出的建议是：<br>1、在生产上可以开自注册，部署两个server<br>2、在本机器上测试的时候，可以把比值调低，比如0.49<br>3、或者简单粗暴把自我保护模式关闭</p>\n<h1 id=\"参考\">参考<a href=\"#参考\" title=\"参考\"></a></h1><p><a href=\"https://www.cnblogs.com/breath-taking/articles/7940364.html\" target=\"_blank\">https://www.cnblogs.com/breath-taking/articles/7940364.html</a></p>\n","prev":{"title":"Springboot-YML配置技巧","link":"2020/03/11/Yml配置技巧"},"next":{"title":"SpringCloudEureka","link":"2020/03/11/SpringCloudEurope"},"plink":"https://blog.bugbak.com/2020/03/11/Eureka-bak-01/","toc":[{"id":"参考","title":"参考","index":"1"}],"reward":true,"copyright":{"author":"Dz","link":"<a href=\"https://blog.bugbak.com/2020/03/11/Eureka-bak-01/\" title=\"Eureka-bak-01\">https://blog.bugbak.com/2020/03/11/Eureka-bak-01/</a>","license":"本博客所有文章除特别声明外，均采用(<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"nofollow\" target=\"_blank\">CC BY-NC-SA 4.0</a>)许可协议，转载请注明来源<a href=\"https://blog.bugbak.com\" rel=\"nofollow\" target=\"_blank\">BugBak</a>"}}